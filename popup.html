<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="popup.css">
</head>
<body>
  <div class="container">
    <!-- Main Menu View -->
    <div id="mainView" class="view active">
      <div class="header">
        <div class="logo">
          <img src="icon-128.png" alt="Tax Form Auto-Fill" width="40" height="40">
        </div>
        <h1 class="title">Tax Form Auto-Fill</h1>
        <p class="subtitle">Sync Excel data with tax forms</p>
      </div>

      <div class="options">
        <button class="option-btn" data-action="import-excel">
          <div class="option-icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
              <path d="M21 16V8C21 6.895 20.105 6 19 6H5C3.895 6 3 6.895 3 8V16C3 17.105 3.895 18 5 18H19C20.105 18 21 17.105 21 16Z" stroke="currentColor" stroke-width="2"/>
              <path d="M3 10H21M8 6V18" stroke="currentColor" stroke-width="2"/>
            </svg>
          </div>
          <div class="option-text">
            <div class="option-title">Import data from Excel</div>
            <div class="option-desc">Load data from Excel workbook</div>
          </div>
        </button>

        <button class="option-btn" data-action="import-tax-form">
          <div class="option-icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
              <path d="M14 2H6C5.46957 2 4.96086 2.21071 4.58579 2.58579C4.21071 2.96086 4 3.46957 4 4V20C4 20.5304 4.21071 21.0391 4.58579 21.4142C4.96086 21.7893 5.46957 22 6 22H18C18.5304 22 19.0391 21.7893 19.4142 21.4142C19.7893 21.0391 20 20.5304 20 20V8L14 2Z" stroke="currentColor" stroke-width="2"/>
              <path d="M14 2V8H20M12 18V12M9 15L12 12L15 15" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </svg>
          </div>
          <div class="option-text">
            <div class="option-title">Import data from tax form</div>
            <div class="option-desc">Load data from existing tax form</div>
          </div>
        </button>

        <button class="option-btn scan-btn" data-action="fill-tax-data">
          <div class="option-icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
              <path d="M9 5H7C5.89543 5 5 5.89543 5 7V19C5 20.1046 5.89543 21 7 21H17C18.1046 21 19 20.1046 19 19V7C19 5.89543 18.1046 5 17 5H15M9 5C9 6.10457 9.89543 7 11 7H13C14.1046 7 15 6.10457 15 5M9 5C9 3.89543 9.89543 3 11 3H13C14.1046 3 15 3.89543 15 4" stroke="currentColor" stroke-width="2"/>
              <path d="M9 12L11 14L15 10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </div>
          <div class="option-text">
            <div class="option-title">Fill tax data on page</div>
            <div class="option-desc">Scan and fill form fields</div>
          </div>
        </button>
      </div>
    </div>

    <!-- Loading View -->
    <div id="loadingView" class="view">
      <div class="loading-container">
        <div class="spinner"></div>
        <p class="loading-text">Loading...</p>
        <p class="loading-subtext">Please wait</p>
      </div>
    </div>

    <!-- Results View -->
    <div id="resultsView" class="view">
      <div class="results-header">
        <button class="back-btn" id="backBtn">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
            <path d="M12.5 15L7.5 10L12.5 5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
        <h2 class="results-title" id="resultsTitle">Success</h2>
      </div>

      <div class="results-content">
        <div class="success-icon">
          <img src="icon-128.png" alt="Success" width="48" height="48">
        </div>
        <p class="results-message" id="resultsMessage">Filled out eligible fields</p>
        <p class="results-website" id="resultsWebsite">Data successfully imported</p>

        <button class="done-btn" id="doneBtn">
          Done
        </button>
      </div>
    </div>

    <!-- Source View -->
    <div id="sourceView" class="view">
      <div class="results-header">
        <button class="back-btn" id="sourceBackBtn">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
            <path d="M12.5 15L7.5 10L12.5 5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>
        <h2 class="results-title">Source Document</h2>
      </div>

      <div class="iframe-container">
        <iframe
          id="sourceIframe"
          allow="camera; clipboard-write; fullscreen; microphone; geolocation"
          sandbox="allow-same-origin allow-scripts allow-forms allow-popups allow-popups-to-escape-sandbox"
        ></iframe>
      </div>
    </div>
  </div>

  <script src="popup.js"></script>
</body>
</html>
